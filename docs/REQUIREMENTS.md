# 요구 사항 분석 with RDD

## 0. 상태 정의: 시스템 책임 파악 -> 한 문장 정의

-   로또 구입 금액과 당첨 번호, 보너스 번호를 사용자로부터 입력받아 로또를 발행하고, 로또 당첨 여부를 판단하여, 당첨 내역과 수익률을 출력한다

-   이 때, (1) UI 영역(입/출력)과 도메인 영역을 분리해 단순화

    -   UI
        -   사용자로부터 콘솔 입력
        -   콘솔 출력
    -   도메인
        -   로또 구입 금액, 당첨 번호, 보너스 번호로 로또를 발행하고,
        -   로또 당첨 여부를 판단하여,
        -   당첨 내역과 수익률을 반환한다.

-   이 때, (2) 가장 작은 단위의 핵심 기능 버전부터 구현 -> 복잡성을 추가하며 버전 확장
    -   가장 작은 단위의 핵심 기능:
        -   Ver1. 로또 한 장을 발행하고, 당첨 등수와 수익률을 반환
    -   확장:
        -   Ver2. 로또 여러 장을 발행하고, 당첨 등수 내역과 누적 수익률을 반환
        -   Ver3. UI 영역 붙이기

## 1. 기능 분리: 시스템 책임을 작은 책임들로 분할

-   feature1. 로또 한 장 발행
-   feature2. 로또 당첨 여부 확인
-   feature3. 당첨 등수, 금액 반환
-   feature4. 수익률 계산

## 2. 객체 협력 컨텍스트 설계: 변경과 확장이 용이하도록

### 2-1. 각 책임에 대해 ROC 분석 -> 도메인 멘탈 모델로 협력 흐름 그리기

### 2-2. 객체 협력 관계도 추출

### 2-3. 목적에 따른 객체 구현 방식 선택

## 3. 세부 기능 구현 순서 지정: 구현 용이성, 최종 상태 근접 여부 기준

-   도메인 영역 먼저 구현 후, UI 영역 코드 붙이기
    -   입/출력 로직 제외하고 선구현
-   f1 -> f2 -> f3 -> f4

## 4. 세부 기능 단위 구현 with TDD

### 4-1. 세부 기능 구체화: 구현 사항 및 edge case 리스트화

#### feature1. 로또 한 장 발행

-   구현 사항

    [V] 1-45 사이 임의의 숫자 생성

    [V] 중복 처리

    [V] 6개의 숫자 배열 반환

-   예외 케이스

#### feature2. 로또 당첨 여부 확인

-   구현 사항

    [V] 당첨 번호와 비교해 일치 개수 세기

    [V] 일치 개수 5개인 경우만, 보너스 번호 일치 여부 확인

    [V] 당첨 시에만 feature3 실행

-   예외 케이스

    [V] 당첨 번호 중복

    [V] 당첨 번호와 보너스 번호 중복

    [V] 당첨 번호 1-45 밖

    [V] 보너스 버호 1-45 밖

#### feature3. 당첨 등수, 금액 반환

-   구현 사항

    [V] 일치 개수 기반 등수 반환

    [V] 등수 기반 금액 반환

-   예외 케이스

    [V] 없는 등수

#### feature4. 수익률 계산

-   구현 사항

    [V] 미당첨 시, 0 반환

    [V] 당첨 시, 당첨 금액/투자금 % 반환

    [V] % 소수점 처리

-   예외 케이스

    [V] 당첨 금액이 0인 경우

    [V] 투자금이 0인 경우

### 4-2. TDD cycle 따라 구현과 리팩토링을 오가며 개발

-   구현: 실패하는 테스트 코드 작성 -> 프로덕션 코드 작성
-   리팩토링: 가독성, 재사용성, 성능 고려

## V1 -> V2 기능 확장

[feature1] 로또 발행 한 장 -> 여러 장

-   PurchasingPrice로 구매가능한 최대한의 로또 개수만큼 로또를 발행한다.
-   로또를 하나도 못 사는 금액을 입력하면, 에러를 발생시킨다.

[feature2] 당첨 여부 판단 한 장 -> 여러 장

-   여러 장의 로또에 대해 당첨 여부를 판단해 ranks에 저장한다.

[feature3] 여러 장에 대해 당첨 등수 통계와 총 수익률을 반환한다.

-   여러 장에 대한 당첨 등수 통계를 반환한다.
-   총 수익률을 반환한다.

## Step2 변경된 요구 사항 반영

### [feature1] 로또 발행

[V] 로또 번호 오름차순 정렬

### [feature5] UI - 재시작/종료 여부 사용자 입력 받기

[V] 사용자로부터 재시작/종료 여부 입력 받기

### 에러 발생 및 처리

-   사용자가 잘못된 값을 입력한 경우 throw 문으로 에러 발생시키고, 에러 메시지 출력 후 해당 부분부터 입력 다시 받기

    [V] purchasingPrice를 잘못 입력한 경우

    [V] winningLottoNumbers를 잘못 입력한 경우

    [V] BonusNumber를 잘못 입력한 경우

    [V] 그 외 Error 발생한 경우, 앱 종료
